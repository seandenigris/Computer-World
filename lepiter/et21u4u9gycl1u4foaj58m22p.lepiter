{
	"__schema" : "4.1",
	"__type" : "page",
	"uid" : {
		"__type" : "uuid",
		"uuid" : "01a0b298-94e0-0d00-9624-e64001401cfa"
	},
	"pageType" : {
		"__type" : "namedPage",
		"title" : "[Dev note]: Emails - Exporting when subject has special characters"
	},
	"children" : {
		"__type" : "snippets",
		"items" : [
			{
				"__type" : "textSnippet",
				"children" : {
					"__type" : "snippets",
					"items" : [ ]
				},
				"createEmail" : {
					"__type" : "email",
					"emailString" : "<unknown>"
				},
				"createTime" : {
					"__type" : "time",
					"time" : {
						"__type" : "dateAndTime",
						"dateAndTimeString" : "2024-11-03T22:16:46.430051-05:00"
					}
				},
				"editEmail" : {
					"__type" : "email",
					"emailString" : "<unknown>"
				},
				"editTime" : {
					"__type" : "time",
					"time" : {
						"__type" : "dateAndTime",
						"dateAndTimeString" : "2024-11-03T22:16:46.430051-05:00"
					}
				},
				"uid" : {
					"__type" : "uid",
					"uidString" : "qyyhc2/iDQCutHlVBIdc5A=="
				},
				"paragraphStyle" : {
					"__type" : "textStyle"
				},
				"string" : "Use case: Email subject contains an emoji. Writing to file via Applescript fails if we naively include the subject in the filename, but how to strip illegal characters?"
			},
			{
				"__type" : "textSnippet",
				"children" : {
					"__type" : "snippets",
					"items" : [ ]
				},
				"createEmail" : {
					"__type" : "email",
					"emailString" : "<unknown>"
				},
				"createTime" : {
					"__type" : "time",
					"time" : {
						"__type" : "dateAndTime",
						"dateAndTimeString" : "2024-11-03T22:16:49.019348-05:00"
					}
				},
				"editEmail" : {
					"__type" : "email",
					"emailString" : "<unknown>"
				},
				"editTime" : {
					"__type" : "time",
					"time" : {
						"__type" : "dateAndTime",
						"dateAndTimeString" : "2024-11-03T22:18:08.488372-05:00"
					}
				},
				"uid" : {
					"__type" : "uid",
					"uidString" : "GrDIc2/iDQCuupDDBIdc5A=="
				},
				"paragraphStyle" : {
					"__type" : "textStyle"
				},
				"string" : "tl;dr: `py-appscript` is alive and well! This meant we can implement the behavior sanely, ditching Apple's basket of absurd \"official\" bridges as well as the poor man's osascript method."
			},
			{
				"__type" : "textSnippet",
				"children" : {
					"__type" : "snippets",
					"items" : [ ]
				},
				"createEmail" : {
					"__type" : "email",
					"emailString" : "<unknown>"
				},
				"createTime" : {
					"__type" : "time",
					"time" : {
						"__type" : "dateAndTime",
						"dateAndTimeString" : "2024-11-03T22:18:13.673687-05:00"
					}
				},
				"editEmail" : {
					"__type" : "email",
					"emailString" : "<unknown>"
				},
				"editTime" : {
					"__type" : "time",
					"time" : {
						"__type" : "dateAndTime",
						"dateAndTimeString" : "2024-11-03T22:18:28.280298-05:00"
					}
				},
				"uid" : {
					"__type" : "uid",
					"uidString" : "Q2zUeG/iDQCy2M/YBIdc5A=="
				},
				"paragraphStyle" : {
					"__type" : "textStyle"
				},
				"string" : "Here is the process as it unfolded for the record..."
			},
			{
				"__type" : "textSnippet",
				"children" : {
					"__type" : "snippets",
					"items" : [ ]
				},
				"createEmail" : {
					"__type" : "email",
					"emailString" : "<unknown>"
				},
				"createTime" : {
					"__type" : "time",
					"time" : {
						"__type" : "dateAndTime",
						"dateAndTimeString" : "2024-10-11T08:45:18.899101-04:00"
					}
				},
				"editEmail" : {
					"__type" : "email",
					"emailString" : "<unknown>"
				},
				"editTime" : {
					"__type" : "time",
					"time" : {
						"__type" : "dateAndTime",
						"dateAndTimeString" : "2024-11-03T22:16:47.093154-05:00"
					}
				},
				"uid" : {
					"__type" : "uid",
					"uidString" : "syuzmJTgDQCWJZoUAUAc+g=="
				},
				"paragraphStyle" : {
					"__type" : "textStyle"
				},
				"string" : "We don't want to work in Applescript any longer than we have to, so let's try returning the selection as a collection of resources and then get the source to write to a file outside of Applescript:"
			},
			{
				"__type" : "pharoSnippet",
				"children" : {
					"__type" : "snippets",
					"items" : [ ]
				},
				"createEmail" : {
					"__type" : "email",
					"emailString" : "<unknown>"
				},
				"createTime" : {
					"__type" : "time",
					"time" : {
						"__type" : "dateAndTime",
						"dateAndTimeString" : "2024-10-11T08:47:34.032341-04:00"
					}
				},
				"editEmail" : {
					"__type" : "email",
					"emailString" : "<unknown>"
				},
				"editTime" : {
					"__type" : "time",
					"time" : {
						"__type" : "dateAndTime",
						"dateAndTimeString" : "2024-10-11T08:53:22.193264-04:00"
					}
				},
				"uid" : {
					"__type" : "uid",
					"uidString" : "dBnBoJTgDQCaci3sAUAc+g=="
				},
				"code" : "selection := Applescript tell: 'Mail' to: 'get selection'.\rselection first get: 'source' via: 'Mail'"
			},
			{
				"__type" : "textSnippet",
				"children" : {
					"__type" : "snippets",
					"items" : [ ]
				},
				"createEmail" : {
					"__type" : "email",
					"emailString" : "<unknown>"
				},
				"createTime" : {
					"__type" : "time",
					"time" : {
						"__type" : "dateAndTime",
						"dateAndTimeString" : "2024-10-13T21:02:31.669756-04:00"
					}
				},
				"editEmail" : {
					"__type" : "email",
					"emailString" : "<unknown>"
				},
				"editTime" : {
					"__type" : "time",
					"time" : {
						"__type" : "dateAndTime",
						"dateAndTimeString" : "2024-10-13T21:03:15.949548-04:00"
					}
				},
				"uid" : {
					"__type" : "uid",
					"uidString" : "p2rcIMfgDQClu1cCAawMRw=="
				},
				"paragraphStyle" : {
					"__type" : "textStyle"
				},
				"string" : "Uh oh, the very message reference returned by Applescript cannot be pasted back into a script!"
			},
			{
				"__type" : "pictureSnippet",
				"children" : {
					"__type" : "snippets",
					"items" : [ ]
				},
				"createEmail" : {
					"__type" : "email",
					"emailString" : "<unknown>"
				},
				"createTime" : {
					"__type" : "time",
					"time" : {
						"__type" : "dateAndTime",
						"dateAndTimeString" : "2024-10-13T21:03:20.448973-04:00"
					}
				},
				"editEmail" : {
					"__type" : "email",
					"emailString" : "<unknown>"
				},
				"editTime" : {
					"__type" : "time",
					"time" : {
						"__type" : "dateAndTime",
						"dateAndTimeString" : "2024-10-13T21:03:37.921232-04:00"
					}
				},
				"uid" : {
					"__type" : "uid",
					"uidString" : "aL7EI8fgDQCobEhZAawMRw=="
				},
				"url" : "attachments/47fd8p4g0euhrbv5vljiwl2kd/Screenshot 2024-10-13 at 9.00.22â€¯PM.png",
				"caption" : "",
				"previewHeight" : 300
			},
			{
				"__type" : "textSnippet",
				"children" : {
					"__type" : "snippets",
					"items" : [ ]
				},
				"createEmail" : {
					"__type" : "email",
					"emailString" : "<unknown>"
				},
				"createTime" : {
					"__type" : "time",
					"time" : {
						"__type" : "dateAndTime",
						"dateAndTimeString" : "2024-10-13T22:03:12.396916-04:00"
					}
				},
				"editEmail" : {
					"__type" : "email",
					"emailString" : "<unknown>"
				},
				"editTime" : {
					"__type" : "time",
					"time" : {
						"__type" : "dateAndTime",
						"dateAndTimeString" : "2024-10-13T22:03:19.810713-04:00"
					}
				},
				"uid" : {
					"__type" : "uid",
					"uidString" : "J3bd+cfgDQC6VvmDAawMRw=="
				},
				"paragraphStyle" : {
					"__type" : "textStyle"
				},
				"string" : "It turns out that the reference only needs to be tweaked a bit to work. This:"
			},
			{
				"__type" : "textSnippet",
				"children" : {
					"__type" : "snippets",
					"items" : [ ]
				},
				"createEmail" : {
					"__type" : "email",
					"emailString" : "<unknown>"
				},
				"createTime" : {
					"__type" : "time",
					"time" : {
						"__type" : "dateAndTime",
						"dateAndTimeString" : "2024-10-13T22:03:22.831096-04:00"
					}
				},
				"editEmail" : {
					"__type" : "email",
					"emailString" : "<unknown>"
				},
				"editTime" : {
					"__type" : "time",
					"time" : {
						"__type" : "dateAndTime",
						"dateAndTimeString" : "2024-10-13T22:03:22.831096-04:00"
					}
				},
				"uid" : {
					"__type" : "uid",
					"uidString" : "uKx8+sfgDQC6hfi2AawMRw=="
				},
				"paragraphStyle" : {
					"__type" : "textStyle"
				},
				"string" : "`message id 1 of mailbox \"INBOX\" of account id \"1234\" of application \"Mail\"`"
			},
			{
				"__type" : "textSnippet",
				"children" : {
					"__type" : "snippets",
					"items" : [ ]
				},
				"createEmail" : {
					"__type" : "email",
					"emailString" : "<unknown>"
				},
				"createTime" : {
					"__type" : "time",
					"time" : {
						"__type" : "dateAndTime",
						"dateAndTimeString" : "2024-10-13T22:03:24.627318-04:00"
					}
				},
				"editEmail" : {
					"__type" : "email",
					"emailString" : "<unknown>"
				},
				"editTime" : {
					"__type" : "time",
					"time" : {
						"__type" : "dateAndTime",
						"dateAndTimeString" : "2024-10-13T22:03:24.627318-04:00"
					}
				},
				"uid" : {
					"__type" : "uid",
					"uidString" : "hx6Y+sfgDQC6jJcsAawMRw=="
				},
				"paragraphStyle" : {
					"__type" : "textStyle"
				},
				"string" : "becomes this:"
			},
			{
				"__type" : "textSnippet",
				"children" : {
					"__type" : "snippets",
					"items" : [ ]
				},
				"createEmail" : {
					"__type" : "email",
					"emailString" : "<unknown>"
				},
				"createTime" : {
					"__type" : "time",
					"time" : {
						"__type" : "dateAndTime",
						"dateAndTimeString" : "2024-10-13T22:03:32.291499-04:00"
					}
				},
				"editEmail" : {
					"__type" : "email",
					"emailString" : "<unknown>"
				},
				"editTime" : {
					"__type" : "time",
					"time" : {
						"__type" : "dateAndTime",
						"dateAndTimeString" : "2024-10-13T22:03:32.291499-04:00"
					}
				},
				"uid" : {
					"__type" : "uid",
					"uidString" : "Jw4N+8fgDQC6ogdmAawMRw=="
				},
				"paragraphStyle" : {
					"__type" : "textStyle"
				},
				"string" : "`first message of mailbox \"INBOX\" of account id \"1234\" of application \"Mail\" whose id is 1`."
			},
			{
				"__type" : "textSnippet",
				"children" : {
					"__type" : "snippets",
					"items" : [ ]
				},
				"createEmail" : {
					"__type" : "email",
					"emailString" : "<unknown>"
				},
				"createTime" : {
					"__type" : "time",
					"time" : {
						"__type" : "dateAndTime",
						"dateAndTimeString" : "2024-10-13T22:03:55.369761-04:00"
					}
				},
				"editEmail" : {
					"__type" : "email",
					"emailString" : "<unknown>"
				},
				"editTime" : {
					"__type" : "time",
					"time" : {
						"__type" : "dateAndTime",
						"dateAndTimeString" : "2024-11-03T22:19:50.829585-05:00"
					}
				},
				"uid" : {
					"__type" : "uid",
					"uidString" : "nzpt/MfgDQC6qAICAawMRw=="
				},
				"paragraphStyle" : {
					"__type" : "textStyle"
				},
				"string" : "I asked why this more convoluted form is needed [on StackOverflow](https://stackoverflow.com/q/79084511). It turns out AppleScript's human readability created an ambiguity because \"message id\" is also a type in the dictionary."
			},
			{
				"__type" : "textSnippet",
				"children" : {
					"__type" : "snippets",
					"items" : [ ]
				},
				"createEmail" : {
					"__type" : "email",
					"emailString" : "<unknown>"
				},
				"createTime" : {
					"__type" : "time",
					"time" : {
						"__type" : "dateAndTime",
						"dateAndTimeString" : "2024-10-13T22:02:34.168267-04:00"
					}
				},
				"editEmail" : {
					"__type" : "email",
					"emailString" : "<unknown>"
				},
				"editTime" : {
					"__type" : "time",
					"time" : {
						"__type" : "dateAndTime",
						"dateAndTimeString" : "2024-10-13T22:44:36.049551-04:00"
					}
				},
				"uid" : {
					"__type" : "uid",
					"uidString" : "DyCW98fgDQC5/3zWAawMRw=="
				},
				"paragraphStyle" : {
					"__type" : "textStyle"
				},
				"string" : "Also, by the time this was discovered, implementation had already shifted from AppleScript to JXA, resulting in {{gtClass:OsaMacMailMessage}}. {{gtMethod:CwMacMail>>selectedMessagesExport}} was reimplemented using it."
			},
			{
				"__type" : "textSnippet",
				"children" : {
					"__type" : "snippets",
					"items" : [ ]
				},
				"createEmail" : {
					"__type" : "email",
					"emailString" : "<unknown>"
				},
				"createTime" : {
					"__type" : "time",
					"time" : {
						"__type" : "dateAndTime",
						"dateAndTimeString" : "2024-11-03T12:27:57.378903-05:00"
					}
				},
				"editEmail" : {
					"__type" : "email",
					"emailString" : "<unknown>"
				},
				"editTime" : {
					"__type" : "time",
					"time" : {
						"__type" : "dateAndTime",
						"dateAndTimeString" : "2024-11-03T22:20:01.774703-05:00"
					}
				},
				"uid" : {
					"__type" : "uid",
					"uidString" : "ZKTaOWfiDQCYqukTCChI6w=="
				},
				"paragraphStyle" : {
					"__type" : "textStyle"
				},
				"string" : "However, this is also unsatisfying because JXA returns the message contents littered with printed \"\\n\". In researching further, it turns out that py-appscript is still alive and well, so that seems to be the best solution at the moment. However, more long term, it would be cool to create a layer where the bridge could be swapped out."
			},
			{
				"__type" : "pharoSnippet",
				"children" : {
					"__type" : "snippets",
					"items" : [ ]
				},
				"createEmail" : {
					"__type" : "email",
					"emailString" : "<unknown>"
				},
				"createTime" : {
					"__type" : "time",
					"time" : {
						"__type" : "dateAndTime",
						"dateAndTimeString" : "2024-11-03T12:31:44.585592-05:00"
					}
				},
				"editEmail" : {
					"__type" : "email",
					"emailString" : "<unknown>"
				},
				"editTime" : {
					"__type" : "time",
					"time" : {
						"__type" : "dateAndTime",
						"dateAndTimeString" : "2024-11-03T12:33:11.855556-05:00"
					}
				},
				"uid" : {
					"__type" : "uid",
					"uidString" : "R4llR2fiDQCh+ylBCChI6w=="
				},
				"code" : "PBApplication uniqueInstance installModule: 'appscript'"
			},
			{
				"__type" : "pythonSnippet",
				"children" : {
					"__type" : "snippets",
					"items" : [ ]
				},
				"createEmail" : {
					"__type" : "email",
					"emailString" : "<unknown>"
				},
				"createTime" : {
					"__type" : "time",
					"time" : {
						"__type" : "dateAndTime",
						"dateAndTimeString" : "2024-11-03T12:33:44.786773-05:00"
					}
				},
				"editEmail" : {
					"__type" : "email",
					"emailString" : "<unknown>"
				},
				"editTime" : {
					"__type" : "time",
					"time" : {
						"__type" : "dateAndTime",
						"dateAndTimeString" : "2024-11-03T22:21:05.908786-05:00"
					}
				},
				"uid" : {
					"__type" : "uid",
					"uidString" : "y5iPTmfiDQCifSgpCChI6w=="
				},
				"code" : "from appscript import *\rapp(\"Mail\").selection.get()[0].source()"
			},
			{
				"__type" : "textSnippet",
				"children" : {
					"__type" : "snippets",
					"items" : [ ]
				},
				"createEmail" : {
					"__type" : "email",
					"emailString" : "<unknown>"
				},
				"createTime" : {
					"__type" : "time",
					"time" : {
						"__type" : "dateAndTime",
						"dateAndTimeString" : "2024-11-03T22:21:12.231039-05:00"
					}
				},
				"editEmail" : {
					"__type" : "email",
					"emailString" : "<unknown>"
				},
				"editTime" : {
					"__type" : "time",
					"time" : {
						"__type" : "dateAndTime",
						"dateAndTimeString" : "2024-11-03T22:21:46.263116-05:00"
					}
				},
				"uid" : {
					"__type" : "uid",
					"uidString" : "ufx4g2/iDQC4drLpBIdc5A=="
				},
				"paragraphStyle" : {
					"__type" : "textStyle"
				},
				"string" : "Which is now the implementation behind this Smalltalk version:"
			},
			{
				"__type" : "pharoSnippet",
				"children" : {
					"__type" : "snippets",
					"items" : [ ]
				},
				"createEmail" : {
					"__type" : "email",
					"emailString" : "<unknown>"
				},
				"createTime" : {
					"__type" : "time",
					"time" : {
						"__type" : "dateAndTime",
						"dateAndTimeString" : "2024-11-03T13:06:37.482004-05:00"
					}
				},
				"editEmail" : {
					"__type" : "email",
					"emailString" : "<unknown>"
				},
				"editTime" : {
					"__type" : "time",
					"time" : {
						"__type" : "dateAndTime",
						"dateAndTimeString" : "2024-11-03T22:20:35.795211-05:00"
					}
				},
				"uid" : {
					"__type" : "uid",
					"uidString" : "op0kxGfiDQCphdKMCChI6w=="
				},
				"code" : "CwMacMail new selection first source"
			}
		]
	},
	"createEmail" : {
		"__type" : "email",
		"emailString" : "<unknown>"
	},
	"createTime" : {
		"__type" : "time",
		"time" : {
			"__type" : "dateAndTime",
			"dateAndTimeString" : "2024-10-11T08:45:18.863654-04:00"
		}
	},
	"editEmail" : {
		"__type" : "email",
		"emailString" : "<unknown>"
	},
	"editTime" : {
		"__type" : "time",
		"time" : {
			"__type" : "dateAndTime",
			"dateAndTimeString" : "2024-11-03T22:37:34.812777-05:00"
		}
	}
}